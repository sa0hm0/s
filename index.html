<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- SEO & Social Preview -->
  <title>مواقيت الصلاة والإضافات الإسلامية</title>
  <meta name="description" content="عرض مواقيت الصلاة، الأذكار، الأدعية، واتجاه القبلة، مع التاريخ الميلادي والهجري.">
  <meta name="keywords" content="أوقات الصلاة, أذكار, أدعية, القبلة, تاريخ هجري, تاريخ ميلادي">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://sa0hm0.github.io/s/">
  <meta property="og:title" content="مواقيت الصلاة والإضافات الإسلامية">
  <meta property="og:description" content="عرض مواقيت الصلاة، الأذكار، الأدعية، واتجاه القبلة، مع التاريخ الميلادي والهجري.">
  <meta property="og:image" content="https://media.discordapp.net/attachments/1316731095391277066/1385612672816513116/raw.png">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="icon" href="https://media.discordapp.net/attachments/1316731095391277066/1385612672816513116/raw.png">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: #f4f9f4;
      font-family: 'Arial', sans-serif;
      color: #0a3d24;
      text-align: center;
      padding-bottom: 40px;
    }
    header {
      position: relative;
      background: #0a3d24 url("https://media.discordapp.net/attachments/1316731095391277066/1385612664574574732/raw.png") center/cover no-repeat;
      color: #fff;
      padding: 60px 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    #siteLogo {
      position: absolute; top: 20px; left: 20px;
      width: 60px; height: auto;
    }
    header h1 {
      font-size: 1.5rem;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.6);
    }
    #menuBtn {
      position: absolute; top: 20px; right: 20px;
      font-size: 1.8rem; color: #fff;
      background: transparent; border: none; cursor: pointer;
    }
    #sideMenu {
      position: fixed; top: 0; right: -250px;
      width: 80%; max-width: 250px; height: 100%;
      background: #033e1b; color: #fff;
      transition: right .3s; padding-top: 60px;
      text-align: right; z-index: 1000;
    }
    #sideMenu a { display: block; padding: 15px 20px; color: #fff; text-decoration: none; border-bottom: 1px solid #045d38; }
    #sideMenu a:hover { background: #045d38; }

    .box {
      width: 90%; max-width: 800px; margin: 20px auto;
      background: #fff; border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 15px; text-align: right; line-height: 1.6;
      display: none;
    }
    .box h2 {
      margin-bottom: 10px; color: #0a3d24;
      border-bottom: 2px solid #0a3d24;
      display: inline-block; padding-bottom: 5px;
      font-size: 1.2rem;
    }
    .controls { margin: 15px 0; display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; }
    .controls select, .controls input, .controls button {
      flex: 1 1 120px; max-width: 200px;
      padding: 8px; font-size: 0.9rem;
      border: 1px solid #0a3d24; border-radius: 4px; outline: none;
    }
    .controls button { background: #0a3d24; color: #fff; cursor: pointer; }
    .controls button:hover { background: #08301c; }

    .times { margin-top: 10px; }
    .times div { display: flex; justify-content: space-between; margin: 6px 0; font-size: 0.9rem; }
    #nextCountdown { margin-top: 10px; font-size: 1rem; font-weight: bold; color: #d35400; }

    .decor-img { width: 100%; border-radius: 6px; margin: 8px 0; }
    #dates { margin: 8px 0; font-size: 0.85rem; }

    #compass { width: 150px; height: 150px; margin: 15px auto;
      background: url('https://cdn-icons-png.flaticon.com/512/54/54417.png') center/contain no-repeat;
      transform-origin: center center; display: none;
    }
    #mobileOnly { color: #d35400; margin-top: 8px; display: none; font-size: 0.85rem; }

    @media (max-width: 600px) {
      .box { width: 95%; margin: 15px auto; }
    }
  </style>
</head>
<body>

  <header>
    <img src="https://media.discordapp.net/attachments/1316731095391277066/1385612672816513116/raw.png" alt="لوجو الموقع" id="siteLogo">
    <h1>مواقيت الصلاة والإضافات الإسلامية</h1>
    <button id="menuBtn">⋮</button>
    <nav id="sideMenu">
      <a href="#" data-page="home">الصفحة الرئيسية</a>
      <a href="#" data-page="adhkar">أذكار</a>
      <a href="#" data-page="duas">أدعية</a>
      <a href="#" data-page="qibla">القبلة</a>
      <a href="#" data-page="khatm">ختم القرآن</a>
      <a href="https://ehsan.sa" target="_blank">إحسان</a>
    </nav>
  </header>

  <img src="https://media.discordapp.net/attachments/1316731095391277066/1385612664574574732/raw.png" alt="بانر الموقع" id="siteBanner">

  <!-- الصفحة الرئيسية -->
  <div id="home" class="box">
    <img class="decor-img" src="https://media.discordapp.net/attachments/1316731095391277066/1385612672816513116/raw.png" alt="مسجد">
    <h2>الصفحة الرئيسية</h2>
    <div id="dates">
      <span id="gregorian"></span> |
      <span id="hijriDateHeader"></span>
    </div>
    <div class="controls">
      <select id="citySelect">
        <option value="Mecca|Saudi Arabia">مكة المكرمة</option>
        <option value="Medina|Saudi Arabia">المدينة المنورة</option>
        <option value="Cairo|Egypt">القاهرة</option>
        <option value="Istanbul|Turkey">إسطنبول</option>
        <option value="London|United Kingdom">لندن</option>
        <option value="New York|USA">نيويورك</option>
        <option value="Dubai|United Arab Emirates">دبي</option>
        <option value="Jakarta|Indonesia">جاكرتا</option>
        <option value="Custom">مخصص...</option>
      </select>
      <input type="text" id="customCity" placeholder="المدينة" style="display:none;">
      <input type="text" id="customCountry" placeholder="الدولة" style="display:none;">
      <button id="loadBtn">موافق</button>
    </div>
    <div id="timesBox" class="box">
      <h2>مواقيت الصلاة</h2>
      <div class="times">
        <div><span>الفجر</span><span id="Fajr"></span></div>
        <div><span>الشروق</span><span id="Sunrise"></span></div>
        <div><span>الظهر</span><span id="Dhuhr"></span></div>
        <div><span>العصر</span><span id="Asr"></span></div>
        <div><span>المغرب</span><span id="Maghrib"></span></div>
        <div><span>العشاء</span><span id="Isha"></span></div>
      </div>
      <p id="nextCountdown"></p>
    </div>
  </div>

  <!-- أذكار -->
  <div id="adhkar" class="box">
    <h2>أذكار الصباح والمساء والعامة</h2>
    <div class="adhkar-section"><h3>أذكار الصباح</h3><ul id="morningList"></ul></div>
    <div class="adhkar-section"><h3>أذكار المساء</h3><ul id="eveningList"></ul></div>
    <div class="adhkar-section"><h3>أذكار عامة</h3><ul id="generalList"></ul></div>
  </div>

  <!-- أدعية -->
  <div id="duas" class="box">
    <h2>أدعية متنوعة</h2>
    <select id="duasSelect">
      <option value="">— اختر دعاء —</option>
      <option value="rain">دعاء نزول المطر</option>
      <option value="fast">دعاء الإفطار للصائم</option>
      <option value="travel">دعاء السفر</option>
      <option value="istikharah">دعاء الاستخارة</option>
      <option value="morning">دعاء الصباح</option>
      <option value="evening">دعاء المساء</option>
    </select>
    <button id="showDuaBtn">عرض الدعاء</button>
    <ul id="duaText" style="margin-top:10px; text-align:right; line-height:1.6;"></ul>
  </div>

  <!-- القبلة -->
  <div id="qibla" class="box">
    <h2>اتجاه القبلة</h2>
    <div id="compass"></div>
    <p id="mobileOnly">هذه الميزة تعمل على الأجهزة المحمولة فقط.</p>
  </div>

  <!-- ختم القرآن -->
  <div id="khatm" class="box">
    <h2>جدول ختم القرآن خلال شهر</h2>
    <table id="khatmTable">
      <thead><tr><th>اليوم</th><th>من الصفحة إلى الصفحة</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    // تنقل بين الأقسام
    const menuBtn = document.getElementById('menuBtn'),
          sideMenu = document.getElementById('sideMenu'),
          links    = sideMenu.querySelectorAll('a[data-page]'),
          boxes    = document.querySelectorAll('.box');
    menuBtn.onclick = () => sideMenu.style.right = sideMenu.style.right==='0px' ? '-250px':'0px';
    links.forEach(link=>link.addEventListener('click', e=>{
      e.preventDefault();
      boxes.forEach(b=>b.id===link.dataset.page?b.style.display='block':b.style.display='none');
      sideMenu.style.right='-250px';
    }));
    links[0].click();

    // عرض التاريخين
    document.getElementById('gregorian').textContent =
      new Date().toLocaleDateString('ar-SA',{weekday:'long',day:'numeric',month:'long',year:'numeric'});
    (async()=>{
      try {
        const d = new Date().toISOString().split('T')[0],
              res = await fetch('https://api.aladhan.com/v1/gToH?date='+d),
              json = await res.json(),
              h = json.data.hijri;
        document.getElementById('hijriDateHeader').textContent =
          h.weekday.ar+'، '+h.day+' '+h.month.ar+' '+h.year;
      } catch {}
    })();

    // إعداد العناصر
    const citySelect    = document.getElementById('citySelect'),
          customCity    = document.getElementById('customCity'),
          customCountry = document.getElementById('customCountry'),
          loadBtn       = document.getElementById('loadBtn'),
          timesEls      = {Fajr:0,Sunrise:0,Dhuhr:0,Asr:0,Maghrib:0,Isha:0},
          nextCountdown = document.getElementById('nextCountdown');
    let currentTimings, currentTimeZone, currentLocale;
    for(let k in timesEls) timesEls[k] = document.getElementById(k);

    citySelect.addEventListener('change', ()=>{
      const isCustom = citySelect.value === 'Custom';
      customCity.style.display    = isCustom ? 'inline-block' : 'none';
      customCountry.style.display = isCustom ? 'inline-block' : 'none';
    });

    function getNowInTimeZone(tz){
      const now = new Date();
      const parts = new Intl.DateTimeFormat('en-US',{
        timeZone: tz, year:'numeric', month:'2-digit', day:'2-digit',
        hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:false
      }).formatToParts(now).reduce((a,p)=>{ if(p.type!=='literal') a[p.type]=p.value; return a; },{});
      return new Date(`${parts.year}-${parts.month}-${parts.day}T${parts.hour}:${parts.minute}:${parts.second}`);
    }

    async function fetchTimings(city,country){
      if(city.toLowerCase()==='mecca') city='Makkah';
      if(city.toLowerCase()==='medina') city='Madinah';
      const method = country.trim()==='Saudi Arabia' ? 5 : 2;
      const url = `https://api.aladhan.com/v1/timingsByCity?city=${encodeURIComponent(city)}&country=${encodeURIComponent(country)}&method=${method}`;
      const res = await fetch(url);
      if(!res.ok) throw new Error(res.statusText);
      const json = await res.json();
      if(!json.data || !json.data.timings) throw new Error('No timings');
      return { timings: json.data.timings, timezone: json.data.meta.timezone };
    }

    loadBtn.addEventListener('click', async()=>{
      let city, country;
      if(citySelect.value==='Custom'){
        city = customCity.value.trim();
        country = customCountry.value.trim();
        if(!city||!country) return alert('أدخل المدينة والدولة');
      } else {
        [city, country] = citySelect.value.split('|');
      }
      currentLocale = country.trim()==='USA' ? 'en-US' : 'ar-SA';
      try {
        document.getElementById('timesBox').style.display = 'block';
        for(let k in timesEls) timesEls[k].textContent = '...';
        const data = await fetchTimings(city, country);
        currentTimings = data.timings;
        currentTimeZone = data.timezone;
        for(let k in timesEls){
          const [h,m] = currentTimings[k].split(':').map(Number);
          let disp;
          if(currentLocale==='ar-SA'){
            const H = h%12||12;
            disp = `${H}:${m.toString().padStart(2,'0')}`;
          } else {
            disp = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}`;
          }
          timesEls[k].textContent = disp;
        }
        startCountdown();
      } catch(e){
        alert('خطأ في جلب البيانات: '+e.message);
      }
    });

    // تحديث تلقائي عند فتح الصفحة
    window.addEventListener('load', ()=>{ loadBtn.click(); });

    function startCountdown(){
      (function cycle(){
        const now = getNowInTimeZone(currentTimeZone);
        const dow = now.getDay();
        const until = (5 - dow + 7) % 7 || 7;
        const target = new Date(now);
        target.setDate(now.getDate()+until);
        target.setHours(12,0,0,0);
        const diff = target - now;
        const days = Math.floor(diff/86400000);
        const hrs  = Math.floor((diff%86400000)/3600000);
        const mins = Math.floor((diff%3600000)/60000);
        const secs = Math.floor((diff%60000)/1000);
        nextCountdown.textContent =
          `الوقت المتبقي لـ الجمعة: ${days>0?days+'ي ':''}${hrs}س ${mins}د ${secs}ث`;
        setTimeout(cycle,1000);
      })();
    }

    // ملء ختم القرآن
    const tbodyKhatm = document.querySelector('#khatmTable tbody');
    for(let i=1;i<=30;i++){
      const tr = document.createElement('tr');
      const td1 = document.createElement('td'), td2 = document.createElement('td');
      td1.textContent = `اليوم ${i}`;
      td2.textContent = `${(i-1)*20+1}–${i*20}`;
      tr.append(td1,td2);
      tbodyKhatm.append(tr);
    }

    // الأذكار
    const morning=['أصبحنا وأصبح الملك لله','رضيت بالله ربا','اللهم بك أصبحنا'],
          evening=['أمسينا وأمسى الملك لله','رضيت بالله ربا','اللهم بك أمسينا'],
          general=['سبحان الله','الحمد لله','لا إله إلا الله','الله أكبر'];
    ['morningList','eveningList','generalList'].forEach((id,i)=>{
      const arr = i===0?morning:i===1?evening:general;
      const ul = document.getElementById(id);
      arr.forEach(txt=>{ const li=document.createElement('li'); li.textContent=txt; ul.append(li); });
    });

    // الأدعية
    const duaList = {
      rain:['اللهم صيبًا نافعًا','اللهم اسقنا الغيث ولا تجعلنا من القانطين'],
      fast:['اللهم إني لك صمت وبك آمنت وعليك توكلت وعلى رزقك أفطرت'],
      travel:['سبحان الذي سخر لنا هذا وما كنا له مقرنين وإنا إلى ربنا لمنقلبون'],
      istikharah:['اللهم إني أستخيرك بعلمك واستقدرك بقدرتك واسألك من فضلك العظيم'],
      morning:['اللهم بك أصبحنا وبك أمسينا وبك نحيا وبك نموت وإليك المصير'],
      evening:['اللهم بك أمسينا وبك أصبحنا وبك نحيا وبك نموت وإليك المصير']
    };
    document.getElementById('showDuaBtn').addEventListener('click',()=>{
      const ul = document.getElementById('duaText');
      ul.innerHTML='';
      (duaList[document.getElementById('duasSelect').value]||[]).forEach(txt=>{
        const li = document.createElement('li');
        li.textContent = txt;
        ul.append(li);
      });
    });

    // القبلة
    if('DeviceOrientationEvent' in window){
      document.getElementById('compass').style.display='block';
      window.addEventListener('deviceorientation',e=>{
        document.getElementById('compass').style.transform = `rotate(${- (e.alpha||0)}deg)`;
      });
    } else {
      document.getElementById('mobileOnly').style.display='block';
    }
  </script>
</body>
</html>
