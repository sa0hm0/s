<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>مواقيت الصلاة والإضافات الإسلامية</title>
  <meta name="description" content="عرض مواقيت الصلاة، الأذكار، الأدعية، واتجاه القبلة، مع التاريخ الميلادي والهجري.">
  <meta property="og:image" content="https://media.discordapp.net/attachments/1316731095391277066/1385612672816513116/raw.png">
  <link rel="icon" href="https://media.discordapp.net/attachments/1316731095391277066/1385612672816513116/raw.png">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0 }
    body {
      font-family: 'Arial', sans-serif;
      background: #f4f9f4; color: #0a3d24;
      text-align: center; padding-bottom: 40px;
    }
    header {
      position: relative;
      background: #0a3d24 url("https://media.discordapp.net/attachments/1316731095391277066/1385612664574574732/raw.png") center/cover no-repeat;
      color: #fff; padding: 60px 20px;
    }
    #siteLogo {
      position: absolute; top: 20px; left: 20px;
      width: 60px;
    }
    header h1 { font-size: 1.5rem; text-shadow: 1px 1px 3px rgba(0,0,0,.6) }
    #menuBtn {
      position: absolute; top: 20px; right: 20px;
      font-size: 1.8rem; background: none; border: none; color: #fff;
      cursor: pointer;
    }
    #sideMenu {
      position: fixed; top: 0; right: -260px; width: 240px; height: 100%;
      background: #033e1b; color: #fff; transition: .3s;
      padding-top: 60px; text-align: right; z-index: 10;
    }
    #sideMenu a {
      display: block; padding: 12px 20px; color: #fff; text-decoration: none;
      border-bottom: 1px solid #045d38;
    }
    #sideMenu a:hover { background: #045d38 }

    .box { display: none; margin: 20px auto; padding: 15px;
      background: #fff; border-radius: 8px; max-width: 800px;
      box-shadow: 0 2px 8px rgba(0,0,0,.1); text-align: right;
    }
    .box h2 {
      display: inline-block; padding-bottom: 5px;
      margin-bottom: 10px; color: #0a3d24;
      border-bottom: 2px solid #0a3d24; font-size: 1.2rem;
    }
    .controls {
      margin: 15px 0; display: flex; flex-wrap: wrap;
      justify-content: center; gap: 8px;
    }
    .controls select, .controls input, .controls button {
      flex: 1 1 120px; max-width: 200px;
      padding: 8px; border: 1px solid #0a3d24;
      border-radius: 4px; font-size: .9rem;
    }
    .controls button {
      background: #0a3d24; color: #fff; cursor: pointer;
    }
    .controls button:hover { background: #08301c }

    .times { margin-top: 10px }
    .times div {
      display: flex; justify-content: space-between;
      margin: 6px 0; font-size: .9rem;
    }
    #nextCountdown {
      margin-top: 10px; font-weight: bold; color: #d35400;
    }

    /* بطاقات المؤاقت */
    #countdowns .card {
      background: #fff; border: 1px solid #ddd;
      border-radius: 8px; padding: 15px;
      margin: 10px 0; text-align: center;
      box-shadow: 0 1px 4px rgba(0,0,0,.1);
    }
    #countdowns .card h3 {
      margin-bottom: 8px; font-size: 1rem; color: #045d38;
    }
    #countdowns .card p {
      font-size: .95rem; line-height: 1.4;
    }

    #compass { width: 150px; height: 150px; margin: 15px auto;
      background: url('https://cdn-icons-png.flaticon.com/512/54/54417.png') center/contain no-repeat;
      transform-origin: center; display: none;
    }
    #mobileOnly { color: #d35400; display: none; margin-top: 8px; }

    @media(max-width:600px){
      .box { width: 95%; }
      #sideMenu { width: 70%; }
    }
  </style>
</head>
<body>

  <header>
    <img id="siteLogo" src="https://media.discordapp.net/attachments/1316731095391277066/1385612672816513116/raw.png" alt="لوجو">
    <h1>مواقيت الصلاة والإضافات الإسلامية</h1>
    <button id="menuBtn">⋮</button>
    <nav id="sideMenu">
      <a href="#" data-page="home">الصفحة الرئيسية</a>
      <a href="#" data-page="adhkar">أذكار</a>
      <a href="#" data-page="duas">أدعية</a>
      <a href="#" data-page="qibla">القبلة</a>
      <a href="#" data-page="countdowns">مؤاقت</a>
      <a href="#" data-page="khatm">ختم القرآن</a>
    </nav>
  </header>

  <!-- الصفحة الرئيسية -->
  <div id="home" class="box">
    <h2>الصفحة الرئيسية</h2>
    <div id="dates">
      <span id="gregorian"></span> |
      <span id="hijriDateHeader"></span>
    </div>
    <div class="controls">
      <select id="citySelect">
        <option value="">— اختر المدينة يدوياً —</option>
        <option value="Mecca|Saudi Arabia">مكة</option>
        <option value="Medina|Saudi Arabia">المدينة</option>
        <option value="Cairo|Egypt">القاهرة</option>
        <option value="Istanbul|Turkey">إسطنبول</option>
        <option value="London|United Kingdom">لندن</option>
        <option value="Custom">مخصص...</option>
      </select>
      <input type="text" id="customCity" placeholder="المدينة" style="display:none;">
      <input type="text" id="customCountry" placeholder="الدولة" style="display:none;">
      <button id="loadBtn">تحديث</button>
    </div>
    <div id="timesBox" class="box">
      <h2>مواقيت الصلاة</h2>
      <div class="times">
        <div><span>الفجر</span><span id="Fajr"></span></div>
        <div><span>الشروق</span><span id="Sunrise"></span></div>
        <div><span>الظهر</span><span id="Dhuhr"></span></div>
        <div><span>العصر</span><span id="Asr"></span></div>
        <div><span>المغرب</span><span id="Maghrib"></span></div>
        <div><span>العشاء</span><span id="Isha"></span></div>
      </div>
      <p id="nextCountdown"></p>
    </div>
  </div>

  <!-- أذكار -->
  <div id="adhkar" class="box">
    <h2>أذكار</h2>
    <ul id="morningList"></ul>
    <ul id="eveningList"></ul>
    <ul id="generalList"></ul>
  </div>

  <!-- أدعية -->
  <div id="duas" class="box">
    <h2>أدعية</h2>
    <select id="duasSelect">
      <option value="">— اختر دعاء —</option>
      <option value="travel">دعاء السفر</option>
      <option value="rain">دعاء المطر</option>
      <option value="fast">دعاء الإفطار</option>
    </select>
    <button id="showDuaBtn">عرض</button>
    <ul id="duaText"></ul>
  </div>

  <!-- القبلة -->
  <div id="qibla" class="box">
    <h2>اتجاه القبلة</h2>
    <div id="compass"></div>
    <p id="mobileOnly">فقط في الأجهزة المحمولة</p>
  </div>

  <!-- مؤاقت -->
  <div id="countdowns" class="box">
    <h2>المؤاقت القادمة</h2>
    <div class="card">
      <h3>باقي على رمضان</h3>
      <p id="toRamadan"></p>
    </div>
    <div class="card">
      <h3>باقي على عيد الفطر</h3>
      <p id="toEidFitr"></p>
    </div>
    <div class="card">
      <h3>باقي على عيد الأضحى</h3>
      <p id="toEidAdha"></p>
    </div>
  </div>

  <!-- ختم القرآن -->
  <div id="khatm" class="box">
    <h2>ختم القرآن</h2>
    <table id="khatmTable">
      <thead><tr><th>اليوم</th><th>من صفحة إلى صفحة</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    // تنقل
    const menuBtn = document.getElementById('menuBtn'),
          sideMenu = document.getElementById('sideMenu'),
          links    = sideMenu.querySelectorAll('a[data-page]'),
          boxes    = document.querySelectorAll('.box');
    menuBtn.onclick = ()=> sideMenu.style.right = sideMenu.style.right==='0px' ? '-260px':'0px';
    links.forEach(l=>{
      l.onclick = e=>{
        e.preventDefault();
        boxes.forEach(b=>b.id===l.dataset.page?b.style.display='block':b.style.display='none');
        sideMenu.style.right='-260px';
      }
    });
    links[0].click();

    // التواريخ
    document.getElementById('gregorian').textContent =
      new Date().toLocaleDateString('ar-SA',{weekday:'long',day:'numeric',month:'long',year:'numeric'});
    (async()=>{
      try {
        const d=new Date().toISOString().slice(0,10),
              j=await fetch('https://api.aladhan.com/v1/gToH?date='+d).then(r=>r.json());
        const h=j.data.hijri;
        document.getElementById('hijriDateHeader').textContent =
          `${h.weekday.ar}، ${h.day} ${h.month.ar} ${h.year}`;
      } catch{}
    })();

    // الأذكار
    const morning=['أصبحنا… لله'], evening=['أمسينا… لله'], general=['سبحان الله','الحمد لله'];
    [ ['morningList',morning], ['eveningList',evening], ['generalList',general] ]
      .forEach(([id,arr])=>{
        const ul=document.getElementById(id);
        arr.forEach(t=>{ const li=document.createElement('li'); li.textContent=t; ul.append(li) });
      });

    // الأدعية
    const duaList={travel:['سبحان…منقلبون'],rain:['اللهم…القانطين'],fast:['اللهم إني…أفطرت']};
    document.getElementById('showDuaBtn').onclick=()=>{
      const out=document.getElementById('duaText');
      out.innerHTML=''; (duaList[document.getElementById('duasSelect').value]||[])
        .forEach(t=>{ const li=document.createElement('li'); li.textContent=t; out.append(li) });
    };

    // ختم القرآن
    const tbody = document.querySelector('#khatmTable tbody');
    for(let i=1;i<=30;i++){
      const tr=document.createElement('tr'),
            td1=document.createElement('td'),
            td2=document.createElement('td');
      td1.textContent=`اليوم ${i}`;
      td2.textContent=`${(i-1)*20+1}–${i*20}`;
      tr.append(td1,td2); tbody.append(tr);
    }

    // القبلة
    if('DeviceOrientationEvent' in window){
      document.getElementById('compass').style.display='block';
      window.addEventListener('deviceorientation',e=>{
        document.getElementById('compass').style.transform=`rotate(${-(e.alpha||0)}deg)`;
      });
    } else document.getElementById('mobileOnly').style.display='block';

    // مواقيت الصلاة بالدقة الكاملة عبر الإحداثيات
    const timesEls={Fajr:null,Sunrise:null,Dhuhr:null,Asr:null,Maghrib:null,Isha:null};
    for(let k in timesEls) timesEls[k]=document.getElementById(k);
    let currentTZ='';
    async function loadByCoords(lat,lng){
      const res=await fetch(`https://api.aladhan.com/v1/timings/${Math.floor(Date.now()/1000)}?latitude=${lat}&longitude=${lng}&method=2`);
      const j=await res.json();
      currentTZ=j.data.meta.timezone;
      Object.entries(j.data.timings).forEach(([k,v])=>{
        const [h,m]=v.split(':');
        timesEls[k].textContent=`${parseInt(h)}:${m.padStart(2,'0')}`;
      });
      document.getElementById('timesBox').style.display='block';
      startNextFriday();
    }
    function startNextFriday(){
      const out=document.getElementById('nextCountdown');
      (function upd(){
        const now=new Date().toLocaleString('en-US',{timeZone:currentTZ}),
              d=new Date(now),
              until=(5 - d.getDay() + 7)%7||7,
              t=new Date(d);
        t.setDate(d.getDate()+until); t.setHours(12,0,0,0);
        let diff=t-d;
        const dys=Math.floor(diff/86400000); diff%=86400000;
        const hrs=Math.floor(diff/3600000), mins=Math.floor((diff%3600000)/60000),
              secs=Math.floor((diff%60000)/1000);
        out.textContent=`باقي على الجمعة: ${dys>0?dys+'ي ':''
                          }${hrs}س ${mins}د ${secs}ث`;
        setTimeout(upd,1000);
      })();
    }

    // إذا سمح الموقع
    if(navigator.geolocation){
      navigator.geolocation.getCurrentPosition(p=>{
        loadByCoords(p.coords.latitude,p.coords.longitude);
      }, _=>{
        // فشل: اترك للمستخدم الاختيار اليدوي
        document.getElementById('timesBox').style.display='block';
      });
    } else {
      document.getElementById('timesBox').style.display='block';
    }
    // زر التحديث اليدوي
    document.getElementById('citySelect').onchange=()=>{
      const c=document.getElementById('citySelect').value;
      const custom=(c==='Custom');
      document.getElementById('customCity').style.display=custom?'inline-block':'none';
      document.getElementById('customCountry').style.display=custom?'inline-block':'none';
    };
    document.getElementById('loadBtn').onclick=async()=>{
      let city,cn;
      if(document.getElementById('citySelect').value==='Custom'){
        city=document.getElementById('customCity').value.trim();
        cn=document.getElementById('customCountry').value.trim();
        if(!city||!cn) return alert('أدخل المدينة والدولة');
      } else [city,cn]=document.getElementById('citySelect').value.split('|');
      const j=await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${cn}&method=2`)
                    .then(r=>r.json());
      currentTZ=j.data.meta.timezone;
      Object.entries(j.data.timings).forEach(([k,v])=>{
        const [h,m]=v.split(':');
        timesEls[k].textContent=`${parseInt(h)}:${m.padStart(2,'0')}`;
      });
      startNextFriday();
    };

    // مؤاقت (رمضان وعيد)
    const toRamadan  = document.getElementById('toRamadan'),
          toEidFitr  = document.getElementById('toEidFitr'),
          toEidAdha  = document.getElementById('toEidAdha');
    const dr = new Date('2026-02-10T00:00:00'),
          df = new Date('2026-03-11T00:00:00'),
          da = new Date('2026-06-16T00:00:00');
    function updAll(){
      const now=new Date();
      [[dr,toRamadan], [df,toEidFitr], [da,toEidAdha]].forEach(([t,el])=>{
        let diff=t-now;
        if(diff<0) return el.textContent='انتهى';
        const dTot=Math.floor(diff/86400000),
              M=Math.floor(dTot/30),
              D=dTot%30;
        diff%=86400000;
        const H=Math.floor(diff/3600000),
              m=Math.floor((diff%3600000)/60000),
              s=Math.floor((diff%60000)/1000);
        el.textContent=`${M}ش ${D}ي ${H}س ${m}د ${s}ث`;
      });
    }
    setInterval(updAll,1000);
    updAll();
  </script>
</body>
</html>
